{
  "title": "Ktor ( client ) ã‚’ 1.6.8 ã‹ã‚‰ 2.0.0 ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹",
  "closed": true,
  "archived": false,
  "created_at": "2022-04-17",
  "comments": [
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "å…¬å¼ã‚¬ã‚¤ãƒ‰ã‚’å‚è€ƒã«ã—ã¦å–ã‚Šæ›ã‹ã‚‹ ğŸ’ª\nhttps://ktor.io/docs/migrating-2.html#client"
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹å‰ã®ä¾å­˜é–¢ä¿‚\n\n```toml:libs.versions.toml\n[versions]\nktor = \"1.6.8\"\n\n[libraries]\nktor-core = { module = \"io.ktor:ktor-client-core\", version.ref = \"ktor\" }\nktor-json = { module = \"io.ktor:ktor-client-json\", version.ref = \"ktor\" }\nktor-logging = { module = \"io.ktor:ktor-client-logging\", version.ref = \"ktor\" }\nktor-okhttp = { module = \"io.ktor:ktor-client-okhttp\", version.ref = \"ktor\" }\nktor-ios = { module = \"io.ktor:ktor-client-ios\", version.ref = \"ktor\" }\nktor-serialization = { module = \"io.ktor:ktor-client-serialization\", version.ref = \"ktor\" }\nktor-mock = { module = \"io.ktor:ktor-client-mock\", version.ref = \"ktor\" }\n```",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "ã¾ãšã¯å˜ç´”ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã¿ä¸Šã’ã¦ã¿ã‚‹\n```diff toml:libs.versions.toml\n[versions]\n- ktor = \"1.6.8\"\n+ ktor = \"2.0.0\"\n\n[libraries]\nktor-core = { module = \"io.ktor:ktor-client-core\", version.ref = \"ktor\" }\nktor-json = { module = \"io.ktor:ktor-client-json\", version.ref = \"ktor\" }\nktor-logging = { module = \"io.ktor:ktor-client-logging\", version.ref = \"ktor\" }\nktor-okhttp = { module = \"io.ktor:ktor-client-okhttp\", version.ref = \"ktor\" }\nktor-ios = { module = \"io.ktor:ktor-client-ios\", version.ref = \"ktor\" }\nktor-serialization = { module = \"io.ktor:ktor-client-serialization\", version.ref = \"ktor\" }\nktor-mock = { module = \"io.ktor:ktor-client-mock\", version.ref = \"ktor\" }\n```"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`JsonFeature` ã‚’ `install` ã—ã¦ã„ãŸã¨ã“ã‚ã§æ—©é€Ÿæ€’ã‚‰ã‚ŒãŸ ğŸ˜‚",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "Content negotiation and serializationï»¿ ã«è¨˜è¼‰ã—ã¦ã‚ã£ãŸ ğŸ¤\nhttps://ktor.io/docs/migrating-2.html#serialization-client\n\nãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ  & ä¿®æ­£ã™ã‚‹ã€‚\n```diff toml:libs.versions.toml\n[versions]\nktor = \"2.0.0\"\n\n[libraries]\nktor-core = { module = \"io.ktor:ktor-client-core\", version.ref = \"ktor\" }\nktor-json = { module = \"io.ktor:ktor-client-json\", version.ref = \"ktor\" }\nktor-logging = { module = \"io.ktor:ktor-client-logging\", version.ref = \"ktor\" }\nktor-okhttp = { module = \"io.ktor:ktor-client-okhttp\", version.ref = \"ktor\" }\nktor-ios = { module = \"io.ktor:ktor-client-ios\", version.ref = \"ktor\" }\n+ ktor-content-negotiation = { module = \"io.ktor:ktor-client-content-negotiation\", version.ref = \"ktor\" }\n+ ktor-serialization = { module = \"io.ktor:ktor-serialization-kotlinx-json\", version.ref = \"ktor\" }\n- ktor-serialization = { module = \"io.ktor:ktor-client-serialization\", version.ref = \"ktor\" }\nktor-mock = { module = \"io.ktor:ktor-client-mock\", version.ref = \"ktor\" }\n```",
          "body_updated_at": "2022-04-17"
        },
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "ã“ã‚“ãªæ„Ÿã˜ã§å¤‰ã‚ã£ãŸã€‚\n\n```diff kt\nimport io.ktor.client.HttpClient\n- import io.ktor.client.features.json.JsonFeature\n- import io.ktor.client.features.json.serializer.KotlinxSerializer\n- import kotlinx.serialization.json.Json\n+ import io.ktor.client.plugins.contentnegotiation.ContentNegotiation\n+ import io.ktor.http.ContentType\n+ import io.ktor.serialization.kotlinx.json.json\n+ import kotlinx.serialization.json.Json\n\nHttpClient(engineFactory = engineFactory) {\n-     install(JsonFeature) {\n-         serializer = KotlinxSerializer(\n-             Json {\n-                 ..\n-             }\n-         )\n-         ..\n-     }\n+     install(ContentNegotiation) {\n+         json(\n+             json = Json {\n+                 ..\n+             },\n+             contentType = ContentType.Application.Json,\n+         )\n+         ..\n+     }\n    ..\n}\n```\n",
          "body_updated_at": "2022-04-17"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`import io.ktor.client.features.*` ãŒ `import io.ktor.client.plugins.*` ã«ãƒªãƒãƒ¼ãƒ ã•ã‚Œã¦ã‚‹ã€‚\n\nhttps://ktor.io/docs/migrating-2.html#feature-plugin-client",
      "body_updated_at": "2022-04-17"
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`io.ktor.client.plugins.HttpCallValidator.Config#handleResponseException` ãŒéæ¨å¥¨ã«ãªã£ã¦ã‚‹ã€‚\n\nhttps://ktor.io/docs/migrating-2.html#response-validation",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "ReplaceWith ã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã¨ãŠã‚Š `io.ktor.client.plugins.HttpCallValidator.Config#handleResponseExceptionWithRequest` ã‚’ä½¿ã†ã§è‰¯ã•ãã†ã€‚\n\n```diff kt\n- import io.ktor.client.HttpClient\n- import io.ktor.client.features.HttpResponseValidator\n+ import io.ktor.client.HttpClient\n+ import io.ktor.client.plugins.HttpResponseValidator\n\nHttpClient(engineFactory = engineFactory) {\n    HttpResponseValidator {\n-         handleResponseException{ cause ->\n+         handleResponseExceptionWithRequest { cause, request ->\n        }\n    }\n    ..\n}\n\n```\n",
          "body_updated_at": "2022-04-17"
        },
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "`io.ktor.client.call.HttpResponse#receive<T>` ãŒéæ¨å¥¨ã«ãªã£ã¦ã‚‹ã€‚"
        },
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "ã“ã‚Œã‚‚ ReplaceWith ã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã¨ãŠã‚Š \n`io.ktor.client.call.HttpResponse#body<T>` ã‚’ä½¿ã†ã§è‰¯ã•ãã†ã€‚\n\nå…¬å¼ã®ç§»è¡Œã‚¬ã‚¤ãƒ‰ã«ã‚‚è¨˜è¿°ãŒã‚ã‚‹ ğŸ‘€\n\nhttps://ktor.io/docs/migrating-2.html#responses",
          "body_updated_at": "2022-04-17"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`SocketTimeoutException` ãŒã‚ã£ãŸ `io.ktor.network.*` ã®åå‰ç©ºé–“ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã¿ãŸã„ã€‚",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "`io.ktor.client.network.*` ã«å¤‰ã‚ã£ã¦ãŸ ğŸ™Œ\n\n```diff kt\n- import io.ktor.network.sockets.SocketTimeoutException\n+ import io.ktor.client.network.sockets.SocketTimeoutException\n```"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`HttpRequestBuilder` ã® `body` ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’ã‚»ãƒƒãƒˆã§ããªããªã£ã¦ã‚‹ã€‚",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "`setBody` ã‚’ä½¿ãˆã°è‰¯ã•ãã†ã€‚\n\nhttps://ktor.io/docs/migrating-2.html#request-body"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "`io.ktor.client.request.builders` ã®æ‹¡å¼µé–¢æ•° `HttpClient#post` ( post ä»¥å¤–ã‚‚ã ã‘ã© ) ãŒ `T` ã§ã¯ãªã `io.ktor.client.statement.HttpResponse` ã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã‚‹ã€‚",
      "children": [
        {
          "author": "tatsutakein",
          "created_at": "2022-04-17",
          "body_markdown": "`post` å‘¼ã‚“ã ã‚ã¨ã« `body` ã‚’å‘¼ã‚“ã§ã‚ã’ã‚Œã°è‰¯ã•ãã†ã€‚\nä½œæ¥­ä¸­ã®ã‚³ãƒ¼ãƒ‰ãŒæŒã£ã¦ãã¥ã‚‰ã„ã®ã§å…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’å¼•ã£å¼µã£ã¦ãã‚‹ã¨ã€ã“ã‚“ãªæ„Ÿã˜ã§å¤‰ã‚ã‚‹ã€‚\n\n```diff kt\n- val customer: Customer = client.get(\"http://localhost:8080/customer/3\")\n+ val customer: Customer = client.get(\"http://localhost:8080/customer/3\").body()\n```\n\nhttps://ktor.io/docs/migrating-2.html#responses",
          "body_updated_at": "2022-04-17"
        }
      ]
    },
    {
      "author": "tatsutakein",
      "created_at": "2022-04-17",
      "body_markdown": "ã‚ˆã—ã‚ƒç§»è¡Œå®Œäº†ï¼\néæ¨å¥¨ã«ãªã£ã¦ãŸé–¢æ•°ã‚‚ ReplaceWith ã§ä½•ã«å¤‰ãˆã‚Œã°ã„ã„ã‹æ›¸ã„ã¦ã‚ã‚‹ã—ã€ç§»è¡Œã‚¬ã‚¤ãƒ‰è‡ªä½“ã‚‚ç´°ã‹ãæ›¸ã‹ã‚Œã¦ã„ã‚‹ã‹ã‚‰æ€ã£ã¦ã„ãŸã‚ˆã‚Šæ¥½ã§ã—ãŸ ğŸ‰ğŸ‰\n\nhttps://ktor.io/docs/migrating-2.html#client"
    }
  ]
}